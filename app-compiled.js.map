{"version":3,"sources":["app.js"],"names":[],"mappings":"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","file":"app-compiled.js","sourcesContent":["\nvar express = require('express');\nvar path = require('path');\nvar favicon = require('serve-favicon');\nvar logger = require('morgan');\nvar cookieParser = require('cookie-parser');\nvar bodyParser = require('body-parser');\nvar ejs = require('ejs');\nvar routes = require('./routes/index');\nvar weixin = require('./routes/weixin.js');\nvar test = require('./routes/test.js');\nvar admin = require('./routes/admin.js');\nvar ueditor = require(\"ueditor\");\nvar session = require('express-session');\nvar RedisStore = require('connect-redis')(session);\nvar config = require('./config/config.js');\n\n\nvar app = express();\n\n// view engine setup\n//app.use(bodyParser.json());\n\n//app.use(bodyParser.urlencoded({ extended: false }));\n\napp.use(cookieParser());\n\napp.use(require('stylus').middleware(path.join(__dirname, 'public')));\napp.use(express.static(path.join(__dirname, 'public')));\napp.use(bodyParser.urlencoded({\n    extended: true,limit: '50mb'\n}))\n//app.use(bodyParser.json());\napp.use(express.static(path.join(__dirname, 'public')));\napp.set('views', path.join(__dirname, 'views'));\napp.use(bodyParser.json({ \"limit\":\"80mb\"}));\n\napp.use(cookieParser('keyboard cat'));\n\napp.use(session({\n    store: new RedisStore({\n        host:config.redisdb.redis_host,\n        port: config.redisdb.redis_port,\n        pass:config.redisdb.redis_psd,\n        db:0\n    }),\n    resave:false,\n    saveUninitialized:false,\n    secret: 'keyboard cat',\n    cookie: { maxAge: 60*60*24*1000}\n}))\n//app.use(express.json({limit: '50mb'}));\n//app.use(express.urlencoded({limit: '50mb'}));\napp.engine('.html', ejs.__express);\napp.set('view engine', 'html');\napp.use('/weixin/',weixin);\napp.use('/test', test);\napp.use('/manager',admin);\napp.use('/', routes);\n\n\napp.use(\"/ueditor/ue/\", ueditor(path.join(__dirname, 'public'), function (req, res, next) {\n    // ueditor 客户发起上传图片请求\n\n    if (req.query.action === 'uploadimage') {\n        var foo = req.ueditor;\n        var date = new Date();\n        var imgname = req.ueditor.filename;\n\n        var img_url = '/images/ueditor/';\n        res.ue_up(img_url); //你只要输入要保存的地址 。保存操作交给ueditor来做\n    }\n    //  客户端发起图片列表请求\n    else if (req.query.action === 'listimage') {\n        var dir_url = '/images/ueditor/';\n        res.ue_list(dir_url); // 客户端会列出 dir_url 目录下的所有图片\n    }\n\n    else {\n        // console.log('config.json')\n        res.setHeader('Content-Type', 'application/json');\n        res.redirect('/ueditor/nodejs/config.json');\n    }\n}));\n\n// catch 404 and forward to error handler\n//app.use(function(req, res, next) {\n//  var err = new Error('Not Found');\n//  err.status = 404;\n//  next(err);\n//});\n//\n//// error handlers\n//\n//// development error handler\n//// will print stacktrace\n//if (app.get('env') === 'development') {\n//  app.use(function(err, req, res, next) {\n//    res.status(err.status || 500);\n//    res.render('error', {\n//      message: err.message,\n//      error: err\n//    });\n//  });\n//}\n//\n//// production error handler\n//// no stacktraces leaked to user\n//app.use(function(err, req, res, next) {\n//  res.status(err.status || 500);\n//  res.render('error', {\n//    message: err.message,\n//    error: {}\n//  });\n//});\n\napp.use(function(req, res, next) {\n    res.render('404');\n});\n\n/*\n\n */\n\n\nvar log4js = require('log4js');\nlog4js.configure('config/log4js.json');\nglobal.logger = log4js.getLogger();\napp.use(log4js.connectLogger(logger,\n    {\n        format: ':method :url HTTP/:http-version :status :res[content-length] - :response-time ms',\n        nolog: [\"\\\\.jpg\", \"\\\\.ico\", \"\\\\.png\", \"\\\\.gif\", \"\\\\.js\", \"\\\\.css\", \"\\\\.swf\"]\n    }));\n\nmodule.exports = app;\n"]}
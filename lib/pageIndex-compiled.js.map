{"version":3,"sources":["pageIndex.js"],"names":[],"mappings":"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","file":"pageIndex-compiled.js","sourcesContent":["/*\n * GET home page.\n */\nvar blog = require('./nedb/blog');\n\nvar config = require(\"./config.js\").config;\nvar tool = require('./tool');\n\nexports.index = function (req, res) {\n    var listli = '';\n    var b = {};\n    b.title = config.title;\n    b.description = config.description;\n\n    var xuanzhong = config.menu;\n    var classname='' ;\n\n    var cSize = req.query.pageSize;\n    req.session.userid ='1' ;\n    console.log(req.session,req.sessionID)\n    if (!cSize) {\n        cSize = 10;\n    }\n\n    var page = parseInt(req.params.page) || 1;\n\n    classname = classname + '<ul class=\"nav pull-right navbar-nav\">';\n    classname = classname + '<li class=\"active\" ><a href=\"/\">首页</a></li>';\n    for (var i = 0; i < xuanzhong.length; i++) {\n\n\n        classname = classname + '<li><a href=\"' + xuanzhong[i].url + '\">' + xuanzhong[i].name + '</a></li>';\n\n    }\n    classname = classname + '</ul>';\n\n    return blog.newlist().then(function(v)\n    {\n                listli = listli + '<ul class=\"grove-list\">';\n                for (var i = 0; i < v.length; i++) {\n                    listli = listli + '<li><h5 class=\\\"media-heading\\\">';\n                    listli = listli + '<a href=\"/blog/' + v[i]._id + '.html\">';\n                    listli = listli + '' + v[i].title + '';\n                    listli = listli + '</a>';\n                    listli = listli + '</li>';\n                    if (i == 10) {\n                        break;\n                    }\n                }\n                listli = listli + '</ul\">';\n                var toplist = [];\n\n                return blog.list().then(function(data)\n                {\n                                if (data) {\n                                    for (var i = 0; i < data.length; i++) {\n                                        var top = data[i];\n                                        if(data[i].content) {\n                                            top.content = tool.delHtmlTag(data[i].content);\n                                        }\n                                        toplist.push(top);\n                                    }\n                                }\n                                data.sort(tool.sortJSONArry('created', true, Date.parse));\n\n                                var ret = {\n                                    page: page,\n                                    perPage: cSize,\n                                    total: data.length,\n                                    items: tool.getPageData(toplist, cSize, page),\n                                    pages: tool.getPageInfo(data.length, cSize).pageCount\n\n                                }\n                                res.render('index', {blog: b, title:config.title,listli: listli, classname: classname, paginate: ret});\n                },function(err)\n                {\n                  //  console.log(err) ;\n                }\n                )\n    }\n    )\n\n};\n\n\n\nfunction findOneid_yuedu(req, res) {\n\n    var id = req.params.id;\n\n    blog.findOneid_yuedu(id).then(function (v) {\n            res.json('q');\n        }\n    );\n}\n\nexports.findOneid_yuedu=findOneid_yuedu ;\n\n"]}